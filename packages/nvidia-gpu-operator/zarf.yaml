# TODO: renovate setup
# yaml-language-server: $schema=https://raw.githubusercontent.com/defenseunicorns/uds-cli/v0.10.4/zarf.schema.json

kind: ZarfPackageConfig
metadata:
  name: nvidia-gpu-operator
  description: "Zarf package of NVIDIA's GPU Operator"
  version: "###ZARF_PKG_TMPL_VERSION###"
  architecture: amd64

components:
  - name: node-feature-discovery
    required: true
    images:
      # gpu-operator pre-requisite via https://github.com/NVIDIA/gpu-operator/blob/main/deployments/gpu-operator/Chart.yaml
      - registry1.dso.mil/ironbank/opensource/nfd/node-feature-discovery:v0.15.4
    charts:
      - name: node-feature-discovery
        namespace: nvidia-gpu-operator
        url: https://kubernetes-sigs.github.io/node-feature-discovery/charts
        version: v0.15.4
        valuesFiles:
          - values/node-feature-discovery-values.yaml

  - name: nvidia-gpu-operator
    required: true
    images:
      - registry1.dso.mil/ironbank/opensource/nvidia/gpu-operator:v24.3.0
      - registry1.dso.mil/ironbank/opensource/nvidia/gpu-operator-validator:v24.3.0
    charts:
      - name: gpu-operator
        url: https://helm.ngc.nvidia.com/nvidia
        # TODO: renovate setup
        version: v24.3.0
        namespace: nvidia-gpu-operator
        valuesFiles:
          - "values/nvidia-gpu-operator-values.yaml"
